function [y,xex,xen,z,wx,wz,ym] = Data
% *************************************************************************
% FUNCTION Data
% *************************************************************************
% Last update: July 16, 2008
% By: Waldyr Areosa; Marcelo C. Medeiros
% *************************************************************************
% Function for
% INSTRUMENTAL VARIABLE ESTIMATION OF SMOOTH TRANSITION REGRESSION MODELS
% WITH ENDOGENOUS VARIABLES
% By
% Waldyr Areosa; Michael McAleer; Marcelo C. Medeiros
% *************************************************************************
% Descripition
% Prepare data to estimate a STR NKPC
% *************************************************************************
% Inputs: None
% -------
%
% Outputs:
% --------
% y      : Regressand
% xex    : Exogenous Regressors
% xen    : Endogenous Regressors
% z      : Logistic Function (Transition Variable)
% wx     : Instruments for x
% wz     : Instruments for z
% ym     : Periods
%
%
% Functions required: None
% -------------------
%
%
%**************************************************************************
% 1. INITIAL DATABASE
%**************************************************************************
% We use the following notation:
% y:        year
% m:        month
% i:        interest rate (per month)
% pi:       inflation (per month)
% cpi:      core inflation (per month)
% fpi:      free-prices inflation (per month)
% fcpi:     free-prices core inflation (per month)
% piat:     inflation expectations for year t (per year) - mean
% piat1:    inflation expectations for year t+1 (per year) - mean
% pimt:     inflation expectations for year t (per year) - median
% pimt1:    inflation expectations for year t+1 (per year) - median
% pist:     inflation expectations for year t (per year) - sd
% pist1:    inflation expectations for year t+1 (per year) - sd
% pit:      inflation target for year t (per year)
% pit1:     inflation target for year t+1 (per year)
% ip:       industrial production (index)
% eb:       nominal exchange rate (bid)
% ea:       nominal exchange rate (ask)
%
% We describe the series after the table:
%
%(1) (2) (3) (4) (5) (6)   (7)  (8)  (9)  (10) (11)  (12) (13) (14) (15) (16) (17) (18)
% y   m   i   pi cpi fpi  fcpi piat piat1 pimt pimt1 pist pist1 pit pit1  ip   eb   ea
base = [
2000 01	1.456	0.620	0.678	0.650	0.708	6.910	4.300	6.940	4.000	0.510	0.470	6.000	4.000	91.940	1.803	1.804
2000 02	1.451	0.130	0.470	0.220	0.430	6.750	4.480	6.790	4.100	0.460	0.680	6.000	4.000	92.060	1.775	1.775
2000 03	1.449	0.220	0.283	-0.110	0.158	6.480	4.470	6.500	4.050	0.380	0.810	6.000	4.000	93.570	1.741	1.742
2000 04	1.296	0.420	0.336	0.540	0.336	6.390	4.430	6.450	4.430	0.380	0.570	6.000	4.000	94.440	1.767	1.768
2000 05	1.494	0.010	0.218	-0.070	0.192	6.100	4.410	6.100	4.300	0.500	0.530	6.000	4.000	94.170	1.827	1.828
2000 06	1.392	0.230	0.276	0.240	0.282	5.940	4.430	5.970	4.250	0.700	0.560	6.000	4.000	96.470	1.808	1.808
2000 07	1.306	1.610	0.732	0.740	0.653	5.970	4.380	5.970	4.220	0.510	0.550	6.000	4.000	97.150	1.797	1.798
2000 08	1.405	1.310	0.637	0.860	0.620	6.250	4.340	6.260	4.290	0.340	0.380	6.000	4.000	97.130	1.808	1.809
2000 09	1.224	0.230	0.402	0.320	0.410	6.230	4.390	6.230	4.300	0.250	0.390	6.000	4.000	95.970	1.838	1.839
2000 10	1.288	0.140	0.266	0.200	0.357	6.200	4.400	6.200	4.300	0.270	0.440	6.000	4.000	98.050	1.879	1.880
2000 11	1.220	0.320	0.213	0.060	0.205	6.140	4.340	6.170	4.300	0.210	0.310	6.000	4.000	97.230	1.947	1.948
2000 12	1.198	0.590	0.150	-0.020	0.183	6.090	4.350	6.020	4.300	0.210	0.380	6.000	4.000	101.600	1.962	1.963
2001 01	1.265	0.570	0.493	0.480	0.514	4.210	3.770	4.200	3.800	0.320	0.390	4.000	3.500	99.140	1.954	1.955
2001 02	1.016	0.460	0.335	0.420	0.273	4.180	3.730	4.200	3.700	0.290	0.380	4.000	3.500	100.160	2.001	2.002
2001 03	1.258	0.380	0.434	0.510	0.368	4.330	3.640	4.300	3.650	0.290	0.280	4.000	3.500	98.750	2.088	2.089
2001 04	1.186	0.580	0.489	0.810	0.473	4.570	3.720	4.550	3.700	0.360	0.350	4.000	3.500	98.410	2.192	2.193
2001 05	1.337	0.410	0.422	0.410	0.413	5.200	3.840	5.200	3.800	0.650	0.450	4.000	3.500	99.170	2.296	2.297
2001 06	1.273	0.520	0.527	0.170	0.426	5.480	3.990	5.600	4.000	0.670	0.580	4.000	3.500	97.940	2.375	2.376
2001 07	1.498	1.330	0.798	0.580	0.682	6.140	4.370	6.100	4.030	0.470	0.640	4.000	3.500	97.700	2.465	2.466
2001 08	1.600	0.700	0.619	0.600	0.571	6.440	4.570	6.430	4.500	0.390	0.520	4.000	3.500	97.720	2.510	2.511
2001 09	1.324	0.280	0.666	0.220	0.664	6.600	4.920	6.600	4.800	0.300	0.800	4.000	3.500	95.850	2.671	2.672
2001 10	1.535	0.830	0.647	0.710	0.671	6.640	5.160	6.670	5.070	0.180	0.590	4.000	3.500	93.650	2.739	2.740
2001 11	1.393	0.710	0.744	0.770	0.802	7.240	5.130	7.290	5.090	0.270	0.550	4.000	3.500	94.740	2.542	2.543
2001 12	1.394	0.650	0.850	0.700	0.844	7.370	4.830	7.400	4.800	0.140	0.590	4.000	3.500	95.020	2.362	2.363
2002 01	1.534	0.520	0.737	0.580	0.773	4.750	3.940	4.800	4.000	0.370	0.450	3.500	3.250	97.380	2.377	2.378
2002 02	1.248	0.360	0.487	0.630	0.448	4.840	3.950	4.870	4.000	0.390	0.460	3.500	3.250	99.130	2.419	2.420
2002 03	1.371	0.600	0.552	0.380	0.524	5.100	4.050	5.040	4.000	0.340	0.480	3.500	3.250	100.320	2.346	2.347
2002 04	1.484	0.800	0.453	0.290	0.406	5.470	4.020	5.460	4.000	0.390	0.410	3.500	3.250	99.130	2.320	2.320
2002 05	1.415	0.210	0.436	0.180	0.428	5.460	4.090	5.460	4.000	0.270	0.490	3.500	3.250	97.860	2.480	2.480
2002 06	1.329	0.420	0.291	0.150	0.312	5.560	4.150	5.530	4.000	0.310	0.570	3.500	4.000	98.990	2.713	2.714
2002 07	1.535	1.190	0.605	0.670	0.515	5.980	4.340	5.990	4.350	0.350	0.600	3.500	4.000	99.890	2.934	2.935
2002 08	1.443	0.650	0.692	0.840	0.658	6.480	4.930	6.430	4.950	0.400	0.920	3.500	4.000	99.390	3.109	3.110
2002 09	1.381	0.720	1.084	1.030	0.973	6.870	5.790	6.820	5.500	0.440	2.310	3.500	4.000	99.920	3.341	3.342
2002 10	1.646	1.310	1.345	1.360	1.320	8.230	8.320	8.370	8.000	0.660	2.850	3.500	4.000	104.450	3.805	3.806
2002 11	1.541	3.020	2.132	2.530	2.068	10.660	10.410	11.000	10.680	1.100	2.360	3.500	4.000	103.280	3.576	3.576
2002 12	1.742	2.100	2.259	2.320	2.312	12.520	11.110	12.560	11.000	0.510	2.270	3.500	4.000	100.250	3.625	3.626
2003 01	1.971	2.250	2.011	1.640	1.934	11.550	8.050	11.440	8.000	1.490	1.660	8.500	3.750	98.660	3.438	3.438
2003 02	1.830	1.570	1.334	1.120	1.243	12.280	8.060	12.330	8.000	1.460	1.610	8.500	3.750	98.260	3.590	3.591
2003 03	1.777	1.230	1.586	1.290	1.640	12.330	7.930	12.260	8.000	1.150	1.500	8.500	3.750	98.390	3.446	3.447
2003 04	1.872	0.970	1.419	0.870	1.388	12.410	7.760	12.390	7.900	0.860	1.040	8.500	3.750	98.730	3.118	3.119
2003 05	1.965	0.610	1.069	0.530	1.081	12.110	7.410	12.170	7.580	0.730	0.920	8.500	3.750	97.650	2.955	2.956
2003 06	1.857	-0.150	0.800	0.200	0.731	11.310	7.140	11.160	7.000	0.740	1.130	8.500	5.500	96.330	2.882	2.883
2003 07	2.084	0.200	0.512	-0.010	0.398	10.020	6.660	10.040	6.500	0.830	1.060	8.500	5.500	97.270	2.879	2.880
2003 08	1.774	0.340	0.367	0.130	0.338	9.510	6.420	9.570	6.200	0.470	0.840	8.500	5.500	98.300	3.002	3.003
2003 09	1.680	0.780	0.603	0.520	0.567	9.610	6.240	9.680	6.200	0.340	0.650	8.500	5.500	102.360	2.922	2.923
2003 10	1.642	0.290	0.498	0.380	0.454	9.690	6.100	9.690	6.000	0.230	0.540	8.500	5.500	104.540	2.861	2.862
2003 11	1.344	0.340	0.382	0.330	0.347	9.240	5.960	9.190	6.000	0.190	0.430	8.500	5.500	105.830	2.913	2.914
2003 12	1.373	0.520	0.471	0.540	0.429	9.200	5.920	9.220	6.000	0.080	0.490	8.500	5.500	103.670	2.925	2.925
2004 01	1.268	0.760	0.682	0.730	0.707	6.000	5.070	6.010	5.000	0.390	0.530	5.500	4.500	103.570	2.851	2.852
2004 02	1.084	0.610	0.448	0.750	0.410	6.060	5.110	6.010	5.000	0.410	0.480	5.500	4.500	103.380	2.930	2.930
2004 03	1.379	0.470	0.693	0.690	0.680	6.030	5.130	6.000	5.000	0.360	0.410	5.500	4.500	105.560	2.905	2.906
2004 04	1.182	0.370	0.648	0.390	0.698	6.170	5.140	6.170	5.000	0.320	0.430	5.500	4.500	105.670	2.905	2.906
2004 05	1.228	0.510	0.598	0.570	0.609	6.480	5.280	6.520	5.280	0.390	0.420	5.500	4.500	107.620	3.100	3.100
2004 06	1.230	0.710	0.627	0.580	0.626	6.920	5.430	6.980	5.500	0.300	0.410	5.500	4.500	107.690	3.128	3.129
2004 07	1.287	0.910	0.540	0.520	0.483	7.170	5.590	7.150	5.500	0.230	0.700	5.500	4.500	109.320	3.036	3.037
2004 08	1.294	0.690	0.477	0.600	0.444	7.300	5.670	7.250	5.520	0.240	0.540	5.500	4.500	110.080	3.002	3.003
2004 09	1.251	0.330	0.570	0.220	0.519	7.340	5.850	7.310	5.800	0.200	0.530	5.500	5.100	110.810	2.890	2.891
2004 10	1.213	0.440	0.600	0.290	0.548	7.190	5.890	7.200	5.900	0.190	0.550	5.500	5.100	111.180	2.852	2.853
2004 11	1.251	0.690	0.630	0.390	0.600	7.290	5.890	7.280	5.800	0.150	0.490	5.500	5.100	110.940	2.785	2.786
2004 12	1.483	0.860	0.650	0.620	0.620	7.460	5.740	7.470	5.700	0.090	0.460	5.500	5.100	111.130	2.717	2.718
2005 01	1.384	0.580	0.690	0.610	0.704	5.750	5.060	5.750	5.000	0.380	0.540	5.100	4.500	110.690	2.692	2.693
2005 02	1.218	0.590	0.720	0.770	0.680	5.710	5.020	5.680	5.000	0.350	0.480	5.100	4.500	108.610	2.597	2.598
2005 03	1.528	0.610	0.570	0.330	0.550	5.920	5.050	5.880	5.000	0.330	0.430	5.100	4.500	110.790	2.704	2.705
2005 04	1.412	0.870	0.760	0.760	0.810	6.280	5.110	6.280	5.000	0.290	0.460	5.100	4.500	110.990	2.578	2.579
2005 05	1.503	0.490	0.690	0.590	0.720	6.330	5.100	6.330	5.000	0.270	0.400	5.100	4.500	111.860	2.452	2.453
2005 06	1.586	-0.020	0.370	0.040	0.330	5.980	5.060	5.970	5.000	0.260	0.400	5.100	4.500	115.010	2.413	2.414
2005 07	1.511	0.250	0.240	0.000	0.220	5.570	5.000	5.540	5.000	0.240	0.360	5.100	4.500	111.860	2.373	2.374
2005 08	1.658	0.170	0.050	-0.050	0.010	5.270	4.840	5.250	4.900	0.260	0.380	5.100	4.500	112.570	2.360	2.361
2005 09	1.503	0.350	0.210	0.100	0.150	5.230	4.690	5.210	4.630	0.230	0.370	5.100	4.500	111.170	2.294	2.294
2005 10	1.407	0.750	0.380	0.380	0.360	5.320	4.620	5.310	4.600	0.130	0.330	5.100	4.500	111.090	2.256	2.257
2005 11	1.381	0.550	0.330	0.420	0.330	5.620	4.590	5.630	4.520	0.110	0.320	5.100	4.500	111.850	2.210	2.211
2005 12	1.474	0.360	0.320	0.290	0.300	5.680	4.550	5.680	4.500	0.050	0.260	5.100	4.500	114.940	2.285	2.286
2006 01	1.429	0.590	0.320	0.600	0.330	4.630	4.490	4.610	4.500	0.270	0.310	4.500	4.500	112.970	2.273	2.274
2006 02	1.145	0.410	0.240	0.400	0.220	4.580	4.500	4.590	4.500	0.240	0.270	4.500	4.500	114.730	2.161	2.162
2006 03	1.422	0.430	0.190	0.310	0.180	4.530	4.510	4.500	4.500	0.220	0.280	4.500	4.500	113.770	2.151	2.152
2006 04	1.078	0.210	0.240	0.040	0.020	4.370	4.490	4.360	4.500	0.230	0.250	4.500	4.500	114.270	2.129	2.129
2006 05	1.281	0.100	0.160	-0.080	0.100	4.290	4.490	4.330	4.500	0.190	0.240	4.500	4.500	115.670	2.177	2.178
2006 06	1.184	-0.210	0.070	-0.350	0.030	3.960	4.490	3.980	4.500	0.240	0.240	4.500	4.500	113.430	2.248	2.248
2006 07	1.170	0.190	0.120	0.130	0.120	3.700	4.480	3.740	4.500	0.230	0.230	4.500	4.500	115.070	2.189	2.189
2006 08	1.256	0.050	0.090	0.090	0.110	3.620	4.430	3.630	4.500	0.250	0.220	4.500	4.500	115.830	2.155	2.156
2006 09	1.057	0.210	0.230	0.210	0.230	3.000	4.270	2.980	4.300	0.210	0.290	4.500	4.500	114.700	2.168	2.169
2006 10	1.094	0.330	0.270	0.430	0.250	2.980	4.180	2.990	4.120	0.110	0.250	4.500	4.500	115.760	2.148	2.148
2006 11	1.021	0.310	0.270	0.450	0.290	3.140	4.130	3.150	4.100	0.100	0.260	4.500	4.500	116.650	2.157	2.158
2006 12	0.988	0.480	0.280	0.320	0.230	3.110	4.020	3.110	4.000	0.050	0.270	4.500	4.500	116.830	2.149	2.150
2007 01	1.083	0.440	0.260	0.520	0.230	4.150	4.180	4.000	4.000	0.370	0.390	4.500	4.500	116.990	2.138	2.139
2007 02	0.872	0.440	0.190	0.590	0.150	4.160	4.150	4.000	4.000	0.330	0.380	4.500	4.500	117.770	2.096	2.096
2007 03	1.052	0.370	0.230	0.440	0.220	4.130	4.160	4.000	4.050	0.330	0.400	4.500	4.500	119.270	2.088	2.089
2007 04	0.945	0.250	0.330	0.190	0.270	4.030	4.110	4.000	4.000	0.330	0.370	4.500	4.500	119.370	2.031	2.032
2007 05	1.028	0.280	0.320	0.250	0.290	3.910	4.000	4.000	4.000	0.360	0.390	4.500	4.500	120.970	1.981	1.982
2007 06	0.910	0.280	0.280	0.430	0.200	3.910	4.000	4.000	4.000	0.370	0.400	4.500	4.500	122.440	1.931	1.931];

selic = [
2000 01	19.000
2000 02	19.000
2000 03	18.952
2000 04	18.500
2000 05	18.500
2000 06	18.166
2000 07	16.951
2000 08	16.500
2000 09	16.500
2000 10	16.500
2000 11	16.500
2000 12	16.233
2001 01	15.524
2001 02	15.250
2001 03	15.411
2001 04	15.950
2001 05	16.379
2001 06	17.248
2001 07	18.564
2001 08	19.000
2001 09	19.000
2001 10	19.000
2001 11	19.000
2001 12	19.000
2002 01	19.000
2002 02	18.929
2002 03	18.661
2002 04	18.500
2002 05	18.500
2002 06	18.500
2002 07	18.274
2002 08	18.000
2002 09	18.000
2002 10	19.636
2002 11	21.332
2002 12	23.249
2003 01	25.145
2003 02	25.821
2003 03	26.500
2003 04	26.500
2003 05	26.500
2003 06	26.300
2003 07	25.611
2003 08	23.607
2003 09	21.129
2003 10	19.709
2003 11	18.448
2003 12	17.047
2004 01	16.500
2004 02	16.500
2004 03	16.387
2004 04	16.117
2004 05	16.000
2004 06	16.000
2004 07	16.000
2004 08	16.000
2004 09	16.125
2004 10	16.427
2004 11	16.966
2004 12	17.508
2005 01	17.943
2005 02	18.464
2005 03	18.992
2005 04	19.325
2005 05	19.605
2005 06	19.750
2005 07	19.750
2005 08	19.750
2005 09	19.617
2005 10	19.306
2005 11	18.883
2005 12	18.226
2006 01	17.685
2006 02	17.250
2006 03	16.693
2006 04	16.224
2006 05	15.750
2006 06	15.250
2006 07	15.056
2006 08	14.734
2006 09	14.250
2006 10	14.040
2006 11	13.733
2006 12	13.250
2007 01	13.194
2007 02	13.000
2007 03	12.806
2007 04	12.650
2007 05	12.500
2007 06	12.100];

qr = [
2000 01	102.9716	98.0256
2000 02	100.9213	98.6063
2000 03	98.6259	99.4193
2000 04	99.4516	99.4774
2000 05	101.3677	99.5935
2000 06	100.9864	100.1160
2000 07	98.0598	100.3480
2000 08	96.2487	100.3480
2000 09	97.3606	100.8710
2000 10	99.3092	101.0450
2000 11	102.2033	101.1030
2000 12	102.8484	101.0450
2001 01	103.4249	101.6840
2001 02	104.5678	102.0910
2001 03	107.8792	102.3230
2001 04	112.9512	102.7290
2001 05	118.0118	103.1940
2001 06	119.1336	103.3680
2001 07	120.2033	103.0780
2001 08	121.9660	103.0780
2001 09	128.8597	103.5420
2001 10	127.8490	103.1940
2001 11	117.3785	103.0200
2001 12	108.7638	102.6130
2002 01	104.9622	102.8460
2002 02	102.0594	103.2520
2002 03	98.4100	103.8330
2002 04	96.6181	104.4130
2002 05	100.9365	104.4130
2002 06	108.0154	104.4720
2002 07	115.3780	104.5880
2002 08	119.1412	104.9360
2002 09	124.3666	105.1100
2002 10	135.5292	105.2850
2002 11	119.8308	105.2850
2002 12	118.5847	105.0520
2003 01	111.3029	105.5170
2003 02	115.8375	106.3300
2003 03	110.8635	106.9690
2003 04	99.0756	106.7360
2003 05	96.7078	106.5620
2003 06	96.2508	106.6780
2003 07	96.3689	106.7940
2003 08	99.5016	107.2010
2003 09	97.2218	107.5490
2003 10	96.5619	107.4330
2003 11	98.1270	107.1430
2003 12	98.9756	107.0270
2004 01	97.4889	107.5490
2004 02	97.8244	108.1300
2004 03	96.3042	108.8270
2004 04	95.1185	109.1750
2004 05	100.4679	109.8140
2004 06	100.2200	110.1630
2004 07	96.1552	109.9880
2004 08	93.4917	110.0460
2004 09	89.3697	110.2790
2004 10	88.1076	110.8590
2004 11	86.4584	110.9180
2004 12	84.5403	110.5110
2005 01	83.7989	110.7430
2005 02	81.1338	111.3820
2005 03	85.4806	112.2530
2005 04	80.6738	113.0080
2005 05	76.7876	112.8920
2005 06	75.7222	112.9500
2005 07	75.3360	113.4730
2005 08	76.4409	114.0530
2005 09	74.9364	115.4470
2005 10	73.5388	115.6790
2005 11	71.3762	114.7500
2005 12	74.1793	114.2860
2006 01	74.1082	115.1570
2006 02	69.9532	115.3890
2006 03	69.8005	116.0280
2006 04	69.9864	117.0150
2006 05	72.3352	117.5960
2006 06	73.8140	117.8280
2006 07	72.4892	118.1770
2006 08	71.9992	118.4090
2006 09	71.6955	117.8280
2006 10	70.4202	117.1890
2006 11	71.6765	117.0150
2006 12	72.0384	117.1890
2007 01	71.1732	117.5470
2007 02	70.7386	118.1760
2007 03	71.3305	119.2520
2007 04	69.5700	120.0270
2007 05	67.6616	120.7600
2007 06	64.5937	120.9940];

y_hat2 = [2000 01	0.11366
2000 02	0.10606
2000 03	0.10077
2000 04	-0.01882
2000 05	0.12718
2000 06	0.04655
2000 07	-0.02162
2000 08	0.04865
2000 09	-0.08995
2000 10	-0.04621
2000 11	-0.10037
2000 12	-0.12051
2001 01	-0.07567
2001 02	-0.26126
2001 03	-0.09001
2001 04	-0.14671
2001 05	-0.04344
2001 06	-0.09446
2001 07	0.05933
2001 08	0.12471
2001 09	-0.07490
2001 10	0.06605
2001 11	-0.03841
2001 12	-0.04349
2002 01	0.04632
2002 02	-0.15374
2002 03	-0.07565
2002 04	-0.00504
2002 05	-0.05640
2002 06	-0.11830
2002 07	0.01342
2002 08	-0.05162
2002 09	-0.09612
2002 10	0.07334
2002 11	0.00165
2002 12	0.12930
2003 01	0.27513
2003 02	0.18226
2003 03	0.14720
2003 04	0.20850
2003 05	0.26941
2003 06	0.20130
2003 07	0.35092
2003 08	0.15308
2003 09	0.09557
2003 10	0.07486
2003 11	-0.11648
2003 12	-0.09327
2004 01	-0.15853
2004 02	-0.27698
2004 03	-0.07541
2004 04	-0.20326
2004 05	-0.16778
2004 06	-0.16189
2004 07	-0.11824
2004 08	-0.10856
2004 09	-0.13340
2004 10	-0.15502
2004 11	-0.12361
2004 12	0.04493
2005 01	-0.01904
2005 02	-0.13140
2005 03	0.09663
2005 04	0.02014
2005 05	0.09352
2005 06	0.16249
2005 07	0.11625
2005 08	0.23510
2005 09	0.12958
2005 10	0.06739
2005 11	0.05811
2005 12	0.14122
2006 01	0.11861
2006 02	-0.09333
2006 03	0.13964
2006 04	-0.12516
2006 05	0.05318
2006 06	-0.01338
2006 07	-0.01139
2006 08	0.07659
2006 09	-0.08054
2006 10	-0.03386
2006 11	-0.08427
2006 12	-0.09974
2007 01	0.00288
2007 02	-0.17912
2007 03	0.00706
2007 04	-0.07981
2007 05	0.01855
2007 06	-0.08229];

mc = [2002 03	0.2019
2002 04	0.1971
2002 05	0.1963
2002 06	0.1946
2002 07	0.2027
2002 08	0.2044
2002 09	0.2088
2002 10	0.1983
2002 11	0.1967
2002 12	0.2036
2003 01	0.2042
2003 02	0.2073
2003 03	0.1983
2003 04	0.1949
2003 05	0.1872
2003 06	0.1909
2003 07	0.1876
2003 08	0.1900
2003 09	0.1847
2003 10	0.1761
2003 11	0.1783
2003 12	0.1792
2004 01	0.1825
2004 02	0.1922
2004 03	0.1822
2004 04	0.1817
2004 05	0.1716
2004 06	0.1722
2004 07	0.1832
2004 08	0.1784
2004 09	0.1847
2004 10	0.1756
2004 11	0.1749
2004 12	0.1723
2005 01	0.1821
2005 02	0.1943
2005 03	0.1837
2005 04	0.1778
2005 05	0.1745
2005 06	0.1743
2005 07	0.1828
2005 08	0.1788
2005 09	0.1817
2005 10	0.1744
2005 11	0.1726
2005 12	0.1777
2006 01	0.1835
2006 02	0.1930
2006 03	0.1858
2006 04	0.1878
2006 05	0.1810
2006 06	0.1808
2006 07	0.1798
2006 08	0.1769
2006 09	0.1833
2006 10	0.1771
2006 11	0.1751
2006 12	0.1818
2007 01	0.1847
2007 02	0.1965
2007 03	0.1861
2007 04	0.1870
2007 05	0.1792
2007 06	0.1821];

% Description of the series
% We obtained all series at IPEAData (www.ipeadata.gov.br)
%
% i: interest rate (Taxa de juros - Over / Selic - (% a.m.))
% Source: BCB Boletim/M.Finan. - BM12_TJOVER12	Quadro: Taxas de juros.  
% For 1974-1979: source Andima.  
% Description: The Overnight rate Selic is the mean of the interest rate
% paid for the government to the banks that lend to the government
% It is a referece rate for the other interest rates of the economy. The
% Selic rate is the base interest rate of the economy.

% pi: inflation rate (Inflação - IPCA - (% a.m.))
% Source; IBGE/SNIPC - PRECOS12_IPCAG12	Índice Nacional de Preços ao Consumidor Amplo (IPCA).
% The IPCA is the price index used for the inflation target

% cpi; Core inflation (Núcleo - IPCA - (% a.m.)) 
% Source: IPEA - GAC12_NUCLEOIPCA	Índice Nacional de Preços ao Consumidor Amplo (IPCA).
% Description: The core inflation é calculado como a média ponderada da 
% variação dos preços dos 512 produtos considerados no cálculo do IPCA. 
% sendo a ponderação de cada produto o desvio da série histórica em relação
% a tendência comum.
% 
% IPCA - preços livres - var. - (% a.m.)
% - IPEA - PRECOS12_IPCAPL12	Índice Nacional de Preços ao Consumidor Amplo (IPCA).  
% Elaboração Banco Central.  
% Obs.: O índice de preços livres exclui os preços monitorados.

% Núcleo preços livres - IPCA - (% a.m.)
% - IPEA - GAC12_NUCLEOLIVRES12	Índice Nacional de Preços ao Consumidor Amplo (IPCA).

% Produção industrial - indústria geral - quantum - índice dessaz. (média 2002 = 100)
% - IBGE/PIM-PF - PIMPFN12_QIIGSAS12	
% A partir de abril de 2004 tem início a divulgação da nova série de
% índices mensais da produção industrial. elaborados com base na Pesquisa 
% Industrial Mensal de Produção Física (PIM-PF) reformulada.

% Taxa de câmbio - R$ / US$ - comercial - compra - média - R$
% - BCB Boletim/BP - BM12_ERC12	Quadro: Taxas de câmbio do real.
% Obs.: Cotações para contabilidade. Os valores dos dois últimos meses são
% obtidos na Gazeta Mercantil.

% Taxa de câmbio - R$ / US$ - comercial - venda - média - R$
% - BCB Boletim/BP - BM12_ERV12	Quadro: Taxas de câmbio do real.
% Obs.: Cotações para contabilidade. Os valores dos dois últimos meses são 
% obtidos na Gazeta Mercantil.


%**************************************************************************
% 2. PREPARE DATA
%**************************************************************************
[T,s]  = size(base);
li      = log(1+(selic(:,3)/100)); % log-annualized series
lpi     = 12*log(1+(base(:,4)/100));
lcpi    = 12*log(1+(base(:,5)/100));
lfpi    = 12*log(1+(base(:,6)/100));
lcfpi   = 12*log(1+(base(:,7)/100));

lpiat   = log(1+(base(:,8)/100)); % log series
lpiat1  = log(1+(base(:,9)/100));
lpimt   = log(1+(base(:,10)/100)); 
lpimt1  = log(1+(base(:,11)/100));
lpist   = log(1+(base(:,12)/100)); 
lpist1  = log(1+(base(:,13)/100));
lpit    = log(1+(base(:,14)/100));
lpit1   = log(1+(base(:,15)/100));

y_hat   = detrend(log(base(:,16)),1);

for t=3:T
    y_hatM(t,1) = mean(y_hat(t-2:t,1));
    dli(t,1)    = li(t,1) - li(t-1,1);
    de(t,1)     = (log((base(t,17)+base(t,18))-log(base(t-1,17)+base(t-1,18))))*0.5;
    dq(t,1)     = de(t,1) + log(qr(t,4)) - log(qr(t-1,4));
    dq2(t,1)    = log(qr(t,3)) - log(qr(t-1,3));
    dq3(t,1)    = dq(t,1) - lpi(t,1);
    pim(t,1)    = log(1+((1/1200)*((12-base(t,2))*(base(t,10)) + base(t,2)*(base(t,11)))));
    piad(t,1)   = log(1+((1/1200)*((12-base(t,2))*(base(t,8)-base(t,14)) + base(t,2)*(base(t,9)-base(t,15)))));
    pimd(t,1)   = log(1+((1/1200)*((12-base(t,2))*(base(t,10)-base(t,14)) + base(t,2)*(base(t,11)-base(t,15)))));
    pism(t,1)   = log(1+((1/1200)*((12-base(t,2))*(base(t,12)) + base(t,2)*(base(t,13)))));
end

sz=std(pism);
sx=std(pimd);
amc=mean(mc(:,3));

% Phillips Curve
% --------------
y = lpi(5:T,1);
xex = [lpi(4:T-1,1) y_hat(4:T-1,1)];
xen = [pimd(5:T,1)];
x = [xex xen];
z = pism(5:T,1)/sz;
wx = [lpi(4:T-1,1) lpi(3:T-2,1) lpi(2:T-3,1) lpi(1:T-4,1) y_hat(4:T-1,1) y_hat(3:T-2,1) pimd(4:T-1,1) pimd(3:T-2,1) dli(4:T-1,1) dli(3:T-2,1) dq(4:T-1,1) dq(3:T-2,1)]; % elements of IS1
wz = [pism(4:T-1,1)/sz pism(3:T-2,1)/sz]; % elements of IS1
%wx = [lpi(4:T-1,1) y_hat(4:T-1,1) pimd(4:T-1,1) dli(4:T-1,1) dq(4:T-1,1)]; % elements of IS2
%wz = [pism(4:T-1,1)/sz]; % elements of IS2
%wx = [lpi(4:T-1,1) lpi(3:T-2,1) y_hat(4:T-1,1) y_hat(3:T-2,1) pimd(4:T-1,1) pimd(3:T-2,1) dli(4:T-1,1) dli(3:T-2,1)]; % elements of IS3
%wz = [pism(4:T-1,1)/sz pism(3:T-2,1)/sz]; % elements of IS3
%wx = [lpi(4:T-1,1) y_hat(4:T-1,1) pimd(4:T-1,1) dli(4:T-1,1)]; % elements of IS4
%wz = [pism(4:T-1,1)/sz]; % elements of IS4
ym = base(5:T,1)+(base(5:T,2)/12);


%**************************************************************************
% 3. PLOT DATA
%**************************************************************************
%Li = T - size(y,1) + 1;
%
%figure('Name','LHS and RHS variables and Instruments');
%subplot(231), plot(ym,100*lpi(Li:T,1)), title('(a) \pi'), grid, axis('tight')
%subplot(232), plot(ym,y_hat(Li:T,1)), title('(b) x'), grid, axis('tight')
%subplot(233), plot(ym,100*pimd(Li:T,1)), title('(c) E\pi'), grid, axis('tight')
%subplot(234), plot(ym,pism(Li:T,1)/sz), title('(d) \sigma_t^\pi'), grid, axis('tight')
%subplot(235), plot(ym,100*dq(Li:T,1)), title('(e) \Deltaq'), grid, axis('tight')
%subplot(236), plot(ym,100*dli(Li:T,1)), title('(f) \Deltai'), grid, axis('tight')
%print -deps 'f1.eps'


%**************************************************************************
% 4. SAVE DATA
%**************************************************************************
DataNKPC = [y xex xen z wx wz ym];
csvwrite('Data',DataNKPC);